<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PS5 Rental Login</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #111;
        color: white;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }

    #container {
        width: 350px;
        padding: 20px;
        background: #222;
        border-radius: 10px;
        box-shadow: 0 0 10px #000;
        text-align: center;
    }

    input {
        width: 90%;
        padding: 12px;
        margin: 10px 0;
        border: none;
        border-radius: 6px;
        font-size: 16px;
    }

    button {
        width: 90%;
        padding: 12px;
        background: #4CAF50;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        color: white;
        cursor: pointer;
    }

    #dashboard {
        display: none;
    }

    #logoutBtn {
        background: #c0392b;
        margin-top: 20px;
    }
</style>
</head>
<body>

<div id="container">

    <!-- LOGIN SCREEN -->
    <div id="loginScreen">
        <h2>Operator Login</h2>
        <input type="text" id="loginUser" placeholder="Username">
        <input type="password" id="loginPass" placeholder="Password">
        <button onclick="login()">Login</button>
        <p id="loginMsg" style="color: red;"></p>
    </div>

    <!-- DASHBOARD SCREEN -->
    <div id="dashboard">
        <h2>Welcome, <span id="opName"></span></h2>
        <p>You are now logged in.</p>

        <button id="logoutBtn" onclick="logout()">Logout</button>
    </div>

</div>

<script>
const API = "YOUR_WEB_APP_URL_HERE"; // Replace with deployed Apps Script URL

// Auto-login if already logged in
window.onload = function() {
    let user = localStorage.getItem("operator");
    if (user) {
        showDashboard(JSON.parse(user).name);
    }
};

// LOGIN FUNCTION
async function login() {
    const username = document.getElementById("loginUser").value;
    const password = document.getElementById("loginPass").value;
    const msg = document.getElementById("loginMsg");

    msg.innerHTML = "Checking...";

    const res = await fetch(API, {
        method: "POST",
        body: JSON.stringify({
            type: "login",
            username: username,
            password: password
        }),
        headers: { "Content-Type": "application/json" }
    });

    const result = await res.json();

    if (result.success) {
        msg.innerHTML = "";

        // SAVE SESSION
        localStorage.setItem("operator", JSON.stringify({
            name: username
        }));

        showDashboard(username);
    } else {
        msg.innerHTML = "Invalid username or password!";
    }
}

// SHOW DASHBOARD
function showDashboard(name) {
    document.getElementById("loginScreen").style.display = "none";
    document.getElementById("dashboard").style.display = "block";
    document.getElementById("opName").innerText = name;
}

// LOGOUT
function logout() {
    localStorage.removeItem("operator");
    location.reload();
}
</script>

</body>
</html>
